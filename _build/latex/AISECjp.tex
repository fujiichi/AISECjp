% Generated by Sphinx.
\def\sphinxdocclass{jsbook}
\newif\ifsphinxKeepOldNames \sphinxKeepOldNamestrue
\documentclass[letterpaper,10pt,dvipdfmx]{sphinxmanual}
\usepackage{iftex}

\ifPDFTeX
  \usepackage[utf8]{inputenc}
\fi
\ifdefined\DeclareUnicodeCharacter
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}

\usepackage{times}

\usepackage{longtable}
\usepackage{sphinx}
\usepackage{multirow}
\usepackage{eqparbox}


\renewcommand{\figurename}{図 }
\renewcommand{\tablename}{TABLE }
\SetupFloatingEnvironment{literal-block}{name=LIST }

\def\pageautorefname{ページ}

\setcounter{tocdepth}{1}


\title{AISECjp 第5回 資料}
\date{9月 21, 2016}
\release{2016-08-24}
\author{Ichiro Fujii}
\newcommand{\sphinxlogo}{}
\renewcommand{\releasename}{リリース}
\makeindex

\makeatletter
\def\PYG@reset{\let\PYG@it=\relax \let\PYG@bf=\relax%
    \let\PYG@ul=\relax \let\PYG@tc=\relax%
    \let\PYG@bc=\relax \let\PYG@ff=\relax}
\def\PYG@tok#1{\csname PYG@tok@#1\endcsname}
\def\PYG@toks#1+{\ifx\relax#1\empty\else%
    \PYG@tok{#1}\expandafter\PYG@toks\fi}
\def\PYG@do#1{\PYG@bc{\PYG@tc{\PYG@ul{%
    \PYG@it{\PYG@bf{\PYG@ff{#1}}}}}}}
\def\PYG#1#2{\PYG@reset\PYG@toks#1+\relax+\PYG@do{#2}}

\expandafter\def\csname PYG@tok@no\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.38,0.68,0.84}{##1}}}
\expandafter\def\csname PYG@tok@nf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.49}{##1}}}
\expandafter\def\csname PYG@tok@il\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@o\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PYG@tok@kn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@gd\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@k\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@cm\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@sc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@mf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c1\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@sr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.14,0.33,0.53}{##1}}}
\expandafter\def\csname PYG@tok@na\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@m\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@go\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.20,0.20,0.20}{##1}}}
\expandafter\def\csname PYG@tok@sb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@cpf\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@nv\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@ow\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@gp\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@mi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@gi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PYG@tok@s\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@kr\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@vi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@w\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PYG@tok@ss\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.32,0.47,0.09}{##1}}}
\expandafter\def\csname PYG@tok@nt\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.45}{##1}}}
\expandafter\def\csname PYG@tok@nn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@ch\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@cs\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\colorbox[rgb]{1.00,0.94,0.94}{\strut ##1}}}
\expandafter\def\csname PYG@tok@se\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@nl\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.13,0.44}{##1}}}
\expandafter\def\csname PYG@tok@gh\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@bp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@mh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@sh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@si\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.44,0.63,0.82}{##1}}}
\expandafter\def\csname PYG@tok@sx\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@ne\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@vc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@mb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@nd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.33,0.33,0.33}{##1}}}
\expandafter\def\csname PYG@tok@gr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@err\endcsname{\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PYG@tok@gt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PYG@tok@ni\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.84,0.33,0.22}{##1}}}
\expandafter\def\csname PYG@tok@gu\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@gs\endcsname{\let\PYG@bf=\textbf}
\expandafter\def\csname PYG@tok@mo\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@kt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.56,0.13,0.00}{##1}}}
\expandafter\def\csname PYG@tok@cp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@s1\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@vg\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@sd\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@s2\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@kp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@ge\endcsname{\let\PYG@it=\textit}

\def\PYGZbs{\char`\\}
\def\PYGZus{\char`\_}
\def\PYGZob{\char`\{}
\def\PYGZcb{\char`\}}
\def\PYGZca{\char`\^}
\def\PYGZam{\char`\&}
\def\PYGZlt{\char`\<}
\def\PYGZgt{\char`\>}
\def\PYGZsh{\char`\#}
\def\PYGZpc{\char`\%}
\def\PYGZdl{\char`\$}
\def\PYGZhy{\char`\-}
\def\PYGZsq{\char`\'}
\def\PYGZdq{\char`\"}
\def\PYGZti{\char`\~}
% for compatibility with earlier versions
\def\PYGZat{@}
\def\PYGZlb{[}
\def\PYGZrb{]}
\makeatother

\renewcommand\PYGZsq{\textquotesingle}

\begin{document}

\maketitle
\tableofcontents
\phantomsection\label{index::doc}

\begin{itemize}
\item {} 
日時： 2016年08月24日（水） 19:30～21:00

\item {} 
場所： マネーフォワード株式会社

\end{itemize}

Contents:


\chapter{第3章　最尤推定法　Maximum Likelihood Estimation}
\label{Chapter_3_MLE::doc}\label{Chapter_3_MLE:maximum-likelihood-estimation}\label{Chapter_3_MLE:aisecjp-5-documentation}\begin{itemize}
\item {} 
日時： 2016年08月24日（水） 19:30～21:00

\item {} 
場所： マネーフォワード株式会社

\item {} 
発表者： 藤井 一郎

\item {} 
内容: 最尤推定法を用いた回帰分析

\end{itemize}


\section{3.1 確率モデルの利用}
\label{Chapter_3_MLE:id1}\begin{quote}

最尤推定法：　あるデータが得られる確率が最大となるようなパラメータを推定
\begin{quote}

（1） パラメータを含むモデル（数式）を設定する

（2） パラメータを評価する基準を定める

（3） 最良の評価を与えるパラメータを決定する
\end{quote}
\end{quote}


\subsection{3.1.1 「データ発生確率」の設定}
\label{Chapter_3_MLE:id2}
\textbf{パラメータを含むモデル（数式）を設定する：}
\begin{quote}

(1)データの背後にはM次多項式の関係があり、さらに標準偏差 \(\sigma\) の誤差が含まれている
\begin{quote}
\begin{equation*}
\begin{split}\it{f}(x) &= w_0 + w_1 x + w_2 x^2 + \cdots + w_M x^M \\
      &= \sum_{m=0}^M w_m x^m\end{split}
\end{equation*}\end{quote}

(2)観測点　\(x_n\) における観測値 \(t\) は、\(f(x_n)\) を中心としておよそ \(f(x_n) \pm \sigma\) の範囲に散らばる
\begin{quote}

(平均 \(f(x_n)\)、分散 \(\sigma\) の正規分布)
\begin{equation*}
\begin{split}\it{N} ( t | f(x_n), \sigma^2 ) = \frac{1}{\sqrt{2 \pi \sigma^2}} e^{- \frac{1}{2 \sigma^2}(t - f(x_n))^2}\end{split}
\end{equation*}\end{quote}

この２つの式の \(w_m\) と \(\sigma\) とを推定する。

最小二乗法との違い：データに含まれる誤差を合わせて推定する

\noindent\sphinxincludegraphics{{AISECjp20160824-fig1}.png}
\end{quote}


\subsection{3.1.2 尤度関数によるパラメーターの評価}
\label{Chapter_3_MLE:id3}\begin{quote}

\textbf{パラメータを評価する基準を定める}

評価方法　=　\emph{尤度関数}：　トレーニングセットに含まれるデータ \(\left \{(x_n,t_n) \right \}^N_{n=1}\) が得られる確率 (パラメータは \(w_m\) と \(\sigma\) )
\begin{equation*}
\begin{split}P &= N(t_1| f(x_1),\sigma^2) \times \cdots \times N(t_N| f(x_N),\sigma^2) \\
  &= \prod_{n=1}^{N} N(t_n| f(x_n),\sigma^2)\end{split}
\end{equation*}
「最尤推定法」
\begin{itemize}
\item {} 
「観測されたデータ（トレーニングセット）は、最も発生確率が高いデータに違いない」との仮説

\item {} 
確率Pが最大になるようなパラーメータを推定

\item {} 
尤度関数の最大値問題

\end{itemize}
\begin{equation*}
\begin{split}P &= \prod_{n=1}^{N} \frac{1}{\sqrt{2 \pi \sigma^2}} e^{- \frac{1}{2 \sigma^2}(t_n - f(x_n))^2} \\
  &= \left (\frac{1}{2 \pi \sigma^2} \right )^{\frac{N}{2}} Exp \left [- \frac{1}{2 \sigma^2} \sum_{n=1}^{N} \{t_n - f(x_n)\}^2 \right ]\end{split}
\end{equation*}
ここで　自乗誤差 \(E_p = \frac{1}{2} \sum_{n=1}^{N} \{ f(x_n) - t_n\}^2 \}\)
\begin{equation*}
\begin{split}P = (\frac{1}{2 \pi \sigma^2})^{\frac{N}{2}} e^{- \frac{1}{\sigma^2} E_p}\end{split}
\end{equation*}
ここで　\(\beta = \frac{1}{\sigma^2}\) とし、 \(E_p\) とパラメータ \(w\) の依存関係を明示
\begin{equation*}
\begin{split}P(\beta,w) = (\frac{\beta}{2 \pi})^{\frac{N}{2}} e^{- \beta E_p(w)}\end{split}
\end{equation*}
これを最大にするパラメータ \((\beta,w)\) を求める。

この尤度関数 \footnote[1]{\sphinxAtStartFootnote%
当初の記述は「単調増加関数なので対数をとっても単調増加する。（対数尤度関数）」としており、勉強会終了後懇親会で尤度関数は単調増加ではないのでは？との質問があった。
}  は
1より小さい値を取る関数を多数かけ合わせたものなので取扱が面倒。そこで対数を取った対数尤度関数を最大化することとする。\footnote[2]{\sphinxAtStartFootnote%
説明資料公開後、尤度関数は単調増加ではないと参考URL(4.)とともに再度ご指摘いただく。確かにその通りでした。m(\_ \_)m
}
\begin{equation*}
\begin{split}ln P(\beta,w) = \frac{N}{2}ln \beta - \frac{N}{2} ln 2 \pi - \beta E_p(w)\end{split}
\end{equation*}
対数尤度関数を最大化する条件：
\begin{equation*}
\begin{split}\frac{\partial (ln P)}{\partial w_m} &= 0  \qquad       (m = 0, \cdots, M) \\
\frac{\partial (ln P)}{\partial \beta} &= 0\end{split}
\end{equation*}\end{quote}
\begin{description}
\item[{　　　\(w_m\) について：}] \leavevmode\begin{equation*}
\begin{split}\frac{\partial E_p}{\partial w_m} = 0 \qquad (m =0, \cdots,M)\end{split}
\end{equation*}
これは自乗誤差を最小にする条件と同じ：

多項式の係数 \(\{w_m\}_{m=0}^{M}\)　は最小二乗法と同じ
\begin{align*}\!\begin{aligned}
\sum_{n=1}^{N} \left ( \sum_{m'=0}^{M} w_{m'} x_n^{m'} -t_n \right ) x_n^m = 0 \\\\
\sum_{m'=0}^{M} w_{m'} \sum_{n=1}^{N} x_n^{m'} x_{n}^{m} - \sum_{n=1}^{N} t_n x_n^m = 0\\
\Phi = \left ( \begin{array}{llll}
         x_1^0 & x_1^1 & \cdots & x_1^M \\
         x_2^0 & x_2^1 & \cdots & x_2^M \\
         \vdots & \vdots & \ddots & \vdots \\
          x_N^0 & x_N^1 & \cdots & x_N^M \\
          \end{array} \right )\\
w^{\mathrm{T}} \Phi^{\mathrm{T}} \Phi - t^{\mathrm{T}} \Phi = 0\\
w = (\Phi^{\mathrm{T}} \Phi)^{-1} \Phi^{\mathrm{T}} t\\
\end{aligned}\end{align*}
\end{description}

　　　\(\beta\) について：
\begin{quote}
\begin{align*}\!\begin{aligned}
\frac{1}{\beta} = \frac{2 E_p}{N}\\
\sigma &= \sqrt{\frac{1}{\beta}} = \sqrt{\frac{2 E_p}{N}} = E_{RMS} \\
       &= \sqrt{\frac{1}{N} \sum_{n=1}^{N} \left ( \sum_{m=0}^{M} w_m x_n^m -t_n \right )^2 }\\
\end{aligned}\end{align*}
これは最小二乗法の平方根平均自乗誤差

\textbf{最小二乗法とは異なるアプローチで計算したが、得られた多項式は同じ}

\textbf{最小二乗法は最尤推定法の中でも正規分布の誤差を仮定した特別な場合}
\end{quote}


\subsection{3.1.3 サンプルコードによる確認}
\label{Chapter_3_MLE:id8}\begin{quote}

計算結果：
\begin{description}
\item[{(1)N=10での結果}] \leavevmode
\noindent\sphinxincludegraphics{{figure_3}.png}

対数尤度の変化を見ることでオーバーフィッティングを調べることができる

\noindent\sphinxincludegraphics{{figure_4}.png}

\item[{(2)N=100での結果}] \leavevmode
\noindent\sphinxincludegraphics{{figure_1}.png}

\noindent\sphinxincludegraphics{{figure_2}.png}

\end{description}
\end{quote}


\section{3.2 単純化した例による解説}
\label{Chapter_3_MLE:id9}\begin{quote}

3.1節では複数の観測点における観測値の予測を行った。
この節では、ある観測点に固定して、繰り返し観測値を取得したデータから平均 \(\mu\) 、標準偏差 \(\sigma\) を最尤推定法で推定してみる。
\begin{equation*}
\begin{split}\mu &= \frac{1}{N} \sum_{n=1}^{N} t_n   \qquad (標本平均） \\
\sigma^2 &= \frac{1}{N} \sum_{n=1}^{N} ( t_n - \mu)^2　　\qquad (標本分散）\end{split}
\end{equation*}
\noindent\sphinxincludegraphics{{figure_2}.png}

推定値（標本分散）は実際の値（母分散）よりも小さくなる傾向がある。（偏りがある）

偏りをなくすために推定値より大きくしてやる（不偏推定量）
\begin{quote}
\begin{equation*}
\begin{split}\sigma^2 = \frac{1}{N-1} \sum_{n=1}^{N} ( t_n - \mu)^2　　\qquad (不偏分散）\end{split}
\end{equation*}\end{quote}

なぜ、 \(N\) ではなく \(N-1\) で割るか？

計算式の中に標本平均が含まれているので、 \((N-1)\) 個の観測データがあれば他のひとつの観測データは正確に値が決められる状態になる。（自由度が　\(N-1\))

(厳密な証明は割愛)
\end{quote}


\section{参考URL：}
\label{Chapter_3_MLE:url}\begin{itemize}
\item {} 
1.人工知能に関する断創録　最尤推定、MAP推定、ベイズ推定 \url{http://cp.the-premium.jp/}

\item {} 
2.最尤法によるパラメータ推定の意味と具体例 \textbar{} 高校数学の美しい物語 \url{http://mathtrain.jp/mle}

\item {} 
3.（おまけ） イラストでわかる自由度と不偏分散 \url{http://home.a02.itscom.net/coffee/tako08Annex2.html}

\item {} 
4.やる夫で学ぶ機械学習 - 対数尤度関数 - \url{http://tkengo.github.io/blog/2016/06/16/yaruo-machine-learning6/}

\end{itemize}


\chapter{AISECjp（Artificial Intelligence x Security） \#5 議事録}
\label{minute-05-20160824::doc}\label{minute-05-20160824:aisecjp-artificial-intelligence-x-security-5}

\section{開催情報}
\label{minute-05-20160824:id1}\begin{itemize}
\item {} 
エンジニアのエンジニアによるエンジニアのための機械学習勉強会

\item {} 
日時：2016年8月24日　19:30～21:30

\item {} 
場所：マネーフォワード株式会社

\end{itemize}


\section{1. 勉強会概要}
\label{minute-05-20160824:id2}
　* 機械学習を各自の専門分野の実務で活用することを目的に，まずは基礎理論の解説本の輪読を行う。
　* 各自の取り組み状況についてのLTもあり。
　* 開催間隔：月１回


\section{2. LT： 通信ログ ダッシュボードの試作}
\label{minute-05-20160824:lt}

\subsection{発表者:}
\label{minute-05-20160824:id3}\begin{itemize}
\item {} 
Suzuki Kengo氏

\item {} 
マネーフォワード㈱

\item {} 
セキュリティエンジニア（防御側）

\item {} 
本勉強会の発起人の１人

\end{itemize}


\subsection{内容：}
\label{minute-05-20160824:id4}\begin{quote}

通信ログを可視化，異常検知した結果を表示するダッシュボードの試作を始めた。

オープンソースのgrayLogを利用。（Suplunkは高くて実用には難あるため）
\begin{itemize}
\item {} 
\url{https://www.graylog.org/}

\item {} 
データ蓄積・分析のバックエンドはmongoDB+ElasticSearchが使われている。

\item {} 
ElasticSearchの可視化によく使われているKibanaよりはシンプルで使いやすそう。（Kibanaは使ったことはないが）

\item {} 
各種ログ形式を標準装備，マーケットプレイスから追加のログ形式や追加機能プラグインを取り込むことも可

\item {} 
全ての機能が無償で利用できる。サポートが必要な場合はサブスクリプション契約。

\end{itemize}

構築中のシステムの現状はアラート出まくりのオオカミ少年状態。実用化には適切なアラートに以下に絞り込むかが課題。
\end{quote}


\subsection{ディスカッション：}
\label{minute-05-20160824:id5}\begin{enumerate}
\item {} 
機器によって形式・内容が異なる等ログのみの解析には限界あるので，最近のトレンドはパケット解析に移っている。ただし，膨大な量のバイナリデータを解析する必要あるので人では実質不可能。AI的手法を活用すべき分野の一つ。

\item {} 
ParoAltoでは異常検知されなかったがパケット解析により判明した社内インシデント事例の紹介あり。

\item {} 
grayLogは日本ではまだほとんど知られていないツール。ユーザ会もない。先駆者になれるかも。

\end{enumerate}


\section{3. 輪読：「ITエンジニアのための機械学習入門」　第３章　最尤推定法}
\label{minute-05-20160824:it-3}

\subsection{発表者}
\label{minute-05-20160824:id6}\begin{description}
\item[{　* Fujii Ichiro}] \leavevmode\begin{itemize}
\item {} 
㈱IHIエスキューブ

\item {} 
重工メーカの社内業務システムの開発・運用を経て現在は技術企画を担当

\end{itemize}

\end{description}


\subsection{内容：}
\label{minute-05-20160824:id7}\begin{quote}

本書における機械学習のステップは以下で説明されている。

(1)パラメータを含むモデル（数式）の設定
(2)パラメータを評価する評価基準の設定
(3)最良の評価を与えるパラメータの決定

最尤推定法を使った回帰分析としては以下の手順となる。

(1)N次多項式のモデルを設定。パラメータは多項式の係数と，データに含まれる標準偏差
データは正規分布に従うと仮定

(2)評価基準は尤度関数（データの出現確率の掛け合わせたもの）

(3)尤度関数を最大化する条件：対数尤度関数を多項式係数および標準偏差の偏微分が０
\begin{itemize}
\item {} 
得られる結果の多項式は，最小二乗法で得られる結果と同一。（データが正規分布に従うと仮定したため。）

\item {} 
最小二乗法は最尤推定法の特殊ケースともいえる。

\item {} 
最尤推定法をさらに拡張したのがベイズ推定法（第８章で解説）

\end{itemize}
\end{quote}


\subsection{ディスカッション：}
\label{minute-05-20160824:id8}\begin{quote}

(1)この手法はどんな分野に応用できるのか？うまいたとえ話があれば。
\begin{itemize}
\item {} 
最尤推定法ではないが，ベイズ推定法は迷惑メールフィルタ，WAF等で実用されている。

\end{itemize}

(2)電子部品メーカので外観検査への機械学習応用を検討している。自分はソフトウェアエンジニアだが数式に立ち入った理解が必要か，それともツールとして使えればよいのか？
\begin{itemize}
\item {} 
ツールが出そろっているのでまずは使ってみるというアプローチもあり。ただし，データ活用のためには一般的には，①業務知識，②数学・統計理論，③ソフトウェアエンジニアリングの３要素が必要。すべてをまかなえる人はいないのでチームで取り組むのがよい。

\item {} 
外観検査ではデータ取る部分でどうしても人手がかかかってしまう。（角度を変えて見てみる等） 将来的には検査対象をロボットアームが動かすような仕組みも必要かもしれない。

\end{itemize}

(3)モデルを３次元グラフで可視化したのが分かりやすかった。どんなツールを使ったのか？
\begin{itemize}
\item {} 
Mathematicaという数式処理ソフトを使用。

\item {} 
\url{https://www.wolfram.com/mathematica/index.ja.html?footer=lang}

\item {} 
数式とプロット範囲を与えればコマンド１行でグラフが描ける（プログラム不要）。

\item {} 
買えば１本数十万のソフトだが，なぜか5000円で買えるRasberryPiにバンドルされている。

\item {} 
私はこのためにRasberryPiを買った。

\end{itemize}
\end{quote}


\section{4. 追加LT: AI技術動向の調査結果について}
\label{minute-05-20160824:lt-ai}

\subsection{発表者：}
\label{minute-05-20160824:id9}\begin{quote}

総合ITベンダー K2(@bonjinjpn)（フォレンジック技術者）
\end{quote}


\subsection{内容＆ディスカッション：}
\label{minute-05-20160824:id10}\begin{quote}

社内の勉強会用に公開情報をまとめたAI技術動向の調査結果についてLT。

機械学習を実務で使うためには，対象の実務知識，数学・統計の知識，プログラミング能力＋英語力が必要ですべてを分かるスーパーマンはいない。そこで社内でチームとして取り組めるように勉強会を始めた。

(1)情報処理学会コンピュータセキュリティ研究会の論文における機械学習関連の論文数は2014年から急増している。

(2)学会のスポンサー枠を見るとどんな企業がその分野に力を入れているのかが分かる。
例えばCVPR, ECCVやICCVなどの国際学会ではパナソニックやDisney Researchがスポンサー枠を持っている。
\begin{quote}

※参考URL

\url{http://www.eccv2016.org/sponsors/}

\url{http://pamitc.org/iccv15/}

\url{http://cvpr2016.thecvf.com/}
\end{quote}

(3)現在第3次AIブームと言われているが少々過熱気味，また冬の時代が訪れるかも。
ただし，これまでとの違いはGPU（ハード）とオープンソースのツール（ソフト）を使って個人が趣味で実績上げているので意外と長続きする可能性も。

(4)人狼知能プロジェクト　AIによる自動文章生成　それなりに意味のある文章が生成できるようになっている。

(5)ROBORACE　自動運転によるフォーミュラーカーレース
\begin{quote}

※参考URL

\url{http://www.roborace.com/}
\end{quote}

(6)現在AIの応用分野は画像認識分野が多いが，AIで実績出ているのはごく一部の領域。まだまだ取り組むべき領域あり。（たとえば，3次元画像復元等）
\end{quote}


\subsection{5． まとめ}
\label{minute-05-20160824:id11}\begin{quote}

今回，初参加のメンバーがほとんどだったが参加者同士のディスカッションが活発に行えて大変有意義だった。
\end{quote}


\chapter{Indices and tables}
\label{index:indices-and-tables}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{索引}
\printindex
\end{document}
